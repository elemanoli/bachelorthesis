\chapter{Derivazione delle distribuzioni binomiale negativa e logaritmica}
Prima di entrare nel merito dei modelli per la stima del numero di specie, vediamo come si possono ricavare la distribuzione binomiale negativa e la distribuzione logaritmica modellizzando la dinamica dell'abbondanza delle specie attraverso un'equazione che descrive la nascita e la morte degli individui : la \emph{birth-death master equation}\cite{2016AzaelePeruzzo}.\\
Entrambe le distribuzioni possono essere derivate da principi primi alla base dei processi biologici: sia $\emph{P}_{\emph{n,s}}(t)$ la probabilità che ad un certo tempo t, la specie \emph{s} abbia esattamente \emph{n} individui, con $\emph{s}\in\left \{ 1,...,S \right \}$. Assumiamo che la dinamica della popolazione di ogni specie sia governata da due termini: i rate di nascita e di morte, rispettivamente, $\emph{b}_\emph{{n,s}}$ e $\emph{d}_\emph{{n,s}}$, per ogni specie \emph{s} con \emph{n} individui.
L'equazione che regola l'evoluzione di $\emph{P}_{\emph{n,s}}(t)$ per $\emph{n}\ge0$ è la seguente:
\begin{equation}
\frac{\partial\emph{P}_{\emph{n,s}}(t)}{\partial\emph{t}}=
\emph{P}_{\emph{n-1,s}}(t)\emph{b}_\emph{{n-1,s}}+\emph{P}_{\emph{n+1,s}}(t)\emph{d}_\emph{{n+1,s}}-\emph{P}_{\emph{n,s}}(t)\emph{b}_\emph{{n,s}}-\emph{P}_{\emph{n,s}}(t)\emph{d}_\emph{{n,s}}.
\label{eq:master}
\end{equation}
Per evitare che \emph{n} sia negativo è necessario imporre delle condizioni al contorno: imponendo condizioni al contorno riflettenti, $\emph{b}_\emph{{-1,s}}=\emph{d}_\emph{{0,s}}=0$. %la (\ref{eq:master}) è valida anche per $\emph{n}=0$ e \emph{n=1}. 
Si trova che per $\emph{n}>0$ la soluzione stazionaria è:
\begin{equation}
\emph{P}_{\emph{n,s}}=P_{0,\emph{s}}\prod_{i=0}^{n-1}\frac{\emph{b}_\emph{{i,s}}}{\emph{d}_\emph{{i+1,s}}}
\label{eq:steadystate}
\end{equation}
dove il termine $P_{0,\emph{s}}$ è il fattore di normalizzazione che può essere trovato imponendo la condizione $\sum_{n=1}^\infty \emph{P}_{\emph{n,s}}=1.$ Notiamo che la somma inizia da \emph{n}=1 in quanto non si considerano specie con abbondanza nulla.\\



\section{Distribuzione binomiale negativa}
Assumiamo che tutti gli individui, siano essi appartenenti a specie rare o comuni, abbiano la stessa probabilità di morire, sopravvivere e riprodursi. Allora i tassi di nascita e morte pro capite non dipendono dal numero di individui \emph{n} appartenenti alla specie.
Definiamo quindi $\emph{b}_\emph{{n,s}}$ come:
\begin{equation}
\emph{b}_\emph{n,s}=\emph{b}_\emph{s}(n+\emph{r}_\emph{s}).
\label{eq:birthNB}
\end{equation}
dove $\emph{b}_\emph{s}$ è il tasso di nascita pro capite, e $\emph{r}_\emph{s}$ è un parametro che tiene conto di eventi di immigrazione o di interazioni intraspecifiche.\newline
Analogamente definiamo $\emph{d}_\emph{n,s}$: 
\begin{equation}
\emph{d}_\emph{n,s}=\emph{d}_\emph{s}\emph{n}.
\label{eq:deathNB}
\end{equation}
dove $\emph{d}_\emph{s}$ è tasso di morte pro capite.
Queste supposizioni sono ragionevoli in ecologia.\\
Sostituendo questi ultimi termini nella (\ref{eq:steadystate}) e denotando con $\xi_\emph{s}=\emph{b}_\emph{s}/\emph{d}_\emph{s}$, si ottiene:
$$
\emph{P}_\emph{n,s}=P_\emph{0,s}\binom{n+\emph{r}_\emph{s}-1}{n}\xi_\emph{s}^n.
$$
La costante di normalizzazione può essere calcolata imponendo:
$$
1=\sum_{n=1}^\infty \emph{P}_{\emph{n,s}}=P_\emph{0,s}\sum_{n=1}^\infty\binom{n+\emph{r}_\emph{s}-1}{n}\xi_\emph{s}^n=P_\emph{0,s}[1-(1-\xi_\emph{s})^{\emph{r}_\emph{s}}](1-\xi_\emph{s})^{-\emph{r}_\emph{s}}
$$
Dunque la probabilità che una specie \emph{s} abbia \emph{n} individui all'equilibrio è data da una binomiale negativa di parametri $(\emph{r}_\emph{s}, \xi_\emph{s})$ e normalizzata per abbondanze non nulle ($n\ge 1$):
\begin{equation}
\emph{P}_\emph{n,s}^{\emph{NB}}=\frac{1}{1-(1-\xi_\emph{s})^{\emph{r}_\emph{s}}}\binom{n+\emph{r}_\emph{s}-1}{n}\xi_\emph{s}^n(1-\xi_\emph{s})^{\emph{r}_\emph{s}}.
\label{eq:NBprobability}
\end{equation}
Sotto l'ipotesi della teoria neutrale secondo la quale le specie sono considerate demograficamente equivalenti, possiamo rimuovere l'indice \emph{s} di specie dall'equazione sopra, ottenendo così una RSA per l'ecosistema in esame.

\section{Distribuzione logaritmica di Fisher}
Notiamo che, scegliendo in modo diverso il termine $\emph{b}_\emph{n,s}$, si può ottenere, partendo dalla \emph{birth death master equation} (\ref{eq:master}), un'altra importante distribuzione: la distribuzione logaritmica di Fisher.
Assumiamo che la dinamica della popolazione di una comunità sia governata dal corso ecologico e dalla speciazione casuale invece che dalla migrazione da comunità esterne.
Allora possiamo porre:
\begin{equation}
    \emph{b}_\emph{n,s}=\emph{b}_\emph{s}n+\delta_\emph{n,0}\nu
\label{eq:birthlog}
\end{equation}
Aggiungendo la condizione al contorno riflettente $\emph{b}_\emph{0,s}=\nu$ si ha che il tasso di nascita tiene conto della riproduzione e della speciazione. In particolare, il parametro $\nu$ assicura che, se le specie si estinguono, la comunità rimane sempre popolata da un individuo.
Dunque sostituendo la (\ref{eq:deathNB}) e la (\ref{eq:birthlog}) nella (\ref{eq:steadystate}) e definendo $\emph{x}_\emph{s}=\emph{b}_\emph{s}/\emph{d}_\emph{s}$, si trova la seguente soluzione stazionaria:
\begin{equation}
    \emph{P}_\emph{n,s}=P_\emph{0,s}\frac{\nu}{\emph{b}_\emph{s}}\frac{\emph{x}_\emph{s}^{\emph{n}}}{\emph{n}}.
\end{equation}
La costante di normalizzazione $P_\emph{0,s}$ si determina imponendo:
$$
1=\sum_{n=1}^\infty \emph{P}_{\emph{n,s}}=P_\emph{0,s}\frac{\nu}{\emph{b}_\emph{s}}\sum_{n=0}^\infty\frac{\emph{x}_\emph{s}^{\emph{n}}}{\emph{n}}=P_\emph{0,s}\frac{\nu}{\emph{b}_\emph{s}}[-\log(1-\emph{x}_\emph{s})].
$$
Dunque abbiamo:
\begin{equation}
    \emph{P}_\emph{n,s}^{\emph{LS}}=-\frac{1}{\log(1-\emph{x}_\emph{s})}\frac{\emph{x}_\emph{s}^{\emph{n}}}{\emph{n}}.
\label{eq:fisherdist}
\end{equation}
Anche in questo caso assumiamo che le specie siano equivalenti e possiamo dunque omettere l'indice \emph{s}.

\subsection{La distribuzione di Fisher come caso particolare della binomiale negativa}
Osserviamo che la distribuzione binomiale negativa converge ad una distribuzione logaritmtica nel limite di \emph{r} che tende a zero:
\begin{equation}
    \lim_{\emph{r} \to 0}\emph{P}_\emph{n}^{\emph{NB}}= \lim_{\emph{r}\to0}\frac{(1-\xi)^{\emph{r}}}{1-(1-\xi)^{\emph{r}}}\binom{n+\emph{r}-1}{n}\xi^n=\frac{\xi^n}{-n\ln(1-\xi)},
\label{eq:convergence}
\end{equation}
dove si è usato il fatto che:
$$
\binom{n+\emph{r}-1}{n}=\frac{\Gamma(\emph{n}+\emph{r})}{\Gamma(\emph{n+1})\Gamma(\emph{r})} \approx\frac{\emph{r}}{\emph{n}},
$$
per $\emph{r}\approx 0$.\\
Notiamo dunque che la (\ref{eq:convergence}) coincide con la (\ref{eq:fisherdist}) ponendo  $\emph{x}=\xi$.


%\section{Protocolli crittografici}
%HTTPS, TLS, Diffie-Hellman, SHA-1
% ---- ELEMENTI UTILI E GIA' PRONTI! ----
%Secondo capitolo della tesi. Esempio di citazione doppia \cite{Munoz-Lipo,Vas}.

%Esempio di figura in \figurename\ \ref{FIG:LogoUniPD}.
%
%\begin{figure}[!htbp]
%\centering
%\includegraphics[width=0.25\textwidth]{./figure//LogoUniPD}
%\caption{Esempio di figura.}
%\label{FIG:LogoUniPD}
%\end{figure}
%
%Esempio di tabella in \tablename\ \ref{TAB:Esempio}.
%
%\begin{table}[!htbp]
%\centering
%\renewcommand{\arraystretch}{1.3}
%\caption{Esempio di tabella.}
%\begin{tabular}{cc}
%\hline
%Nome & Valore \\
%\hline
%a & 1 \\
%b & 2 \\
%c & 3 \\
%d & 4 \\
%e & 5 \\
%f & 6 \\
%\hline
%\end{tabular}
%\label{TAB:Esempio}
%\end{table}